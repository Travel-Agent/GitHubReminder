{{#partial 'title'}}Settings{{/partial}}
{{#partial 'startHeading'}}{{/partial}}
{{#partial 'endHeading'}}{{/partial}}
{{#partial 'content'}}
<section>
  <h2>Your GitHub account</h2>

  <img src="{{avatar}}" class="avatar" alt=""/>

  <p class="username">{{user}}</p>

  <h3>Recently starred repositories</h3>

  <ul>
    {{#each repos}}
    <li>
      <a class="repo" href="{{html_url}}" target="_blank">
        <h4>{{full_name}}</h4>

        <p class="description">{{description}}</p>

        <ul>
          <li class="stat">
            <h5>Language</h5>:
            {{language}}
          </li>

          <li class="stat">
            <h5>Stars</h5>:
            {{watchers_count}}
          </li>

          <li class="stat">
            <h5>Forks</h5>:
            {{forks_count}}
          </li>
        </ul>
      </a>
    </li>
    {{/each}}
  </ul>

  <p class="signout">
    Wrong account?
    <a href="/signout">Sign out</a>.
  </p>
</section>

<section>
  <h2>Reminder settings</h2>

  {{#if isSaved}}
  <p class="news good">Your settings have been saved.</p>
  {{/if}}
  {{#if isFailed}}
  <p class="news bad">Your settings have not been saved because {{reason}}.</p>
  {{/if}}
  {{#if isAwaitingVerification}}
  <p class="news indifferent">
    Your email address must be verified
    before your settings are made active.
    An email has been sent
    to {{verificationEmail}};
    if you click on the link in that email,
    your reminders will be activated.
  </p>
  {{/if}}

  <form class="clearfix" method="POST" action="/settings">
    <label for="select-email">Email address</label>
    <select name="email" id="select-email" data-visibility-control="#input-email,#input-email-label" data-visibility-option="other">
      {{#email}}
      <option value="{{address}}"{{#if isSelected}} selected="selected"{{/if}}>{{address}}</option>
      {{/email}}
      <option value="other"{{#if isOtherEmail}} selected="selected"{{/if}}>Other</option>
    </select>

    <label for="input-email" id="input-email-label">Other email address</label>
    <input type="text" name="otherEmail" id="input-email" value="{{otherEmail}}"/>

    <label for="select-frequency">Frequency</label>
    <select name="frequency" id="select-frequency">
      <!-- TODO: Handlebars helper to DRY this out -->
      <option value="daily"{{#if isDaily}} selected="selected"{{/if}}>Daily</option>
      <option value="weekly"{{#if isWeekly}} selected="selected"{{/if}}>Weekly</option>
      <option value="monthly"{{#if isMonthly}} selected="selected"{{/if}}>Monthly</option>
    </select>

    <!-- TODO: Offer setting reminder time (in user's time zone) -->
    <!-- TODO: Offer setting reminder day -->

    <div class="control">
      <input class="inline-control control-part checkbox" type="checkbox" name="immediate" id="input-checkbox" value="true"/>
      <label class="control-part" for="input-immediate">Send a reminder immediately?</label>
    </div>

    <input class="inline-control submit" type="submit" value="Save"/>
  </form>

  {{#if isSubscribed}}
  <a class="cancel" href="/cancel">Cancel reminders</a>
  {{/if}}
</section>
{{/partial}}
{{> layout}}
